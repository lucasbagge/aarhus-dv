---
title: "√òvelse 4"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## 2.09

Let x1 <x2 <¬∑¬∑¬∑<xn and y1 <y2 <¬∑¬∑¬∑<yn be two sets of data with means x, y and medians mx , my , respectively. Let wi = xi + yi for i = 1,2,...,n.
a) Proveorgiveacounterexample:x+yisthemeanofw1,w2,...,wn.
b) Prove or give a counterexample: mx + my is the median of w1,w2,...,wn.

(a)True.(w1 +w2 +¬∑¬∑¬∑+wn)‚àïn=(nx+ny)‚àïn=x+y.(b)True.


## 3.10

In the black spruce case study in Section 1.10, seedlings were planted in plots that were either subject to competition (from other plants) or not. Use the data set Spruce to conduct a test to see if the mean difference in how much the seedlings grew (in height) over the course of the study under these two treatments is statistically significant.

```{r}
data <- read.csv("MatStat-R/data/Spruce.csv")
```

```{r}
mv <- tapply(data$Ht.change, data$Competition, mean)
mv
```

```{r}
obs_diff = abs(mv[1] - mv[2])
obs_diff
```

```{r}
nsim <-  10^4 - 1
sim_differens <- numeric(nsim)
set.seed(1234)

for(i in 1:nsim) {
  sim_vaekst <- tapply(data$Ht.change, sample(data$Competition), mean)
  sim_differens[i] <- abs(sim_vaekst[1] - sim_vaekst[2])
}
```

```{r}
options(scipen = 999)
p_lower <- (sum(sim_differens <= obs_diff) + 1) / (nsim + 1)
p_greater <- (sum(sim_differens >= obs_diff) + 1) / (nsim + 1)

pval <- 2* min(p_lower, p_greater)
pval
```

Vores null hypotese antager at der ikke er noget forhold mellem de to means.
Med en lav p v√¶rdi forkaster vi H0 og dermed er resultater statistik signifikant
og der er en klar sammenh√¶ng.

## 4.10

Suppose the heights of boys in a certain large city follow a distribution with mean 48 in. and variance 81. Use the CLT approximation to estimate the probability that in a random sample of 30 boys, the mean height is more than 51 in.

vi bruger pbinom

```{r}
1 - pnorm((51 - 48) / sqrt(81 / 30))
```



## 4.14

According to the 2000 census, 28.6% of the US adult population received a high school diploma. In a random sample of 800 US adults, what is the probability that between 220 and 230 (inclusive) people have a high school diploma? Use the CLT approximation with continuity correction, and compare with the exact probability (use pbinom in R).

Vores model blive

X ~ binom(n = 800, p = 0.286)

Her leder vi efter 

P(220 <= X <= 230)

```{r}
pbinom(230, 800, 0.286) - pbinom(219, 800, 0.286)
```

Uden kontinutetiskorrektur.

```{r}
ex = 800 * 0.286

varx <- 800*0.286 *(1-0.286)

```

## OMS 4.A



## MSRR 4.26

Prove Theorem 4.2.1.

Vink: Teoremet vistes for den uniforme fordeling U[0, 1] under forel√¶sningen d. 18.2.


Suppose we have continuous random variables X1, X2, ... , Xn that are i.i.d. with pdf f and cdf F. Define their minimum and maximum to be the random variables

Uniform fordeling?




## MSRR 4.24

Let X1 , X2 , ... , X30 ‚àº Exp(1‚àï3) and let X denote the sample mean.

### a) Simulate the sampling distribution of X in R.

```{r}
sample_means = rep(NA, 1000)
for(i in 1:1000){
  sample_means[i] = mean(rexp(40,0.2))
}
```


## b) Find the mean and standard error of the sampling distribution, and
compare with the theoretical results.

```{r}
library(tidyverse)
set.seed(123)
sims <- 1000
xbar <- numeric(sims)
xvar <- numeric(sims)
for(i in 1:sims){
  xbar[i] <- mean(rexp(30, 1/3))
  xvar[i] <- sd(rexp(30, 1/3))  
}
mean(xbar)
sd(xvar)
```

the theoretical mean

```{r}
1/ (1/3)
```

theoreticl variance

```{r}
the_var <- ((1/(1/3))^2)/30
the_var^0.5
```



c) From your simulation, find P(X ‚â§ 3.5).



d) Estimate P(X ‚â§ 3.5) by assuming the CLT approximation holds. Compare this result with the one in part (c).



## MSRR 4.30

i.i.d. ‚àíùúÜx LetX1,X2,...,Xn ‚àº Exp(ùúÜ)withpdff(x)=ùúÜe ,ùúÜ>0,x>0.
### a) Find the pdf fmin(x) for the sample minimum Xmin. Recognize this as the pdf of a known distribution.

Vores pdf er

$$
f(x)=\lambda\cdot e^{-\lambda x}
$$
Til at starte med skal vi finde CDF

$$
CDF = -e^{-\lambda\cdot x}+e^{-\lambda}
$$

inds√¶t nu i formel 4.2.1

$$
f_{min}(x)=n(1-F(x))^{n-1}f(x)
$$
$$
n(1+e^{-\lambda\cdot x}-e^{-\lambda})^{n-1}\cdot\lambda\cdot e^{-\lambda x}
$$


## b) Simulate in R the sampling distribution of Xmin of samples of size n = 25 from the exponential distribution with ùúÜ = 7. Compare the theoretical expected value of Xmin with the simulated expected value.


## MSRR 4.21

Let X1,X2,...,Xn be a random sample from N(0,1). Let W = X12 + X2 + ... + Xn2. Describe the sampling distribution of W by running a simula- tion, using n = 2. What is the mean and variance of the sampling distri- bution of W? Repeat using n = 4, n = 5. What observations or conjec- tures do you have for general n?


```{r}
set.seed(1234)
size <- 1000
w2 <- numeric(size)
w4 <- numeric(size)
w5 <- numeric(size)
for(i in 1:size){
  w2[i] <- sum(rnorm(2) ^ 2)
  w4[i] <- sum(rnorm(4) ^ 2)
  w5[i] <- sum(rnorm(5) ^ 2)
}

library(glue)

glue(
  "
  Vi kan se at for w2 er mean: {mean(w2)} og dens varians er {var(w2)}.
  Vi kan se at for w2 er mean: {mean(w4)} og dens varians er {var(w4)}.
  Vi kan se at for w2 er mean: {mean(w5)} og dens varians er {var(w5)}.
  Og man l√¶gger m√¶rke til at mean er typisk n og variansen er 2n.
  "
)
```

## MSRR 4.34

> Let X1, X2, ... , Xn be independent random variables from N(ùúá, ùúé2). We
are interested in the sampling distribution of the variance. Run the fol- lowing script in R, which draws random samples of size 20 from N (25, 72 ) and calculates the variance for each sample.

```{r}
W <- numeric(1000)

for(i in 1:1000) {
  x <- rnorm(20,25,7)
  W[i] <- var(x)
}
mean(W)
var(W)
hist(W)
qqnorm(W)
qqline(W)
```

```{r}
W <- numeric(1000)

for(i in 1:1000) {
  x <- rnorm(20,50,7)
  W[i] <- var(x)
}
mean(W)
var(W)
hist(W)
qqnorm(W)
qqline(W)
```

```{r}
W <- numeric(1000)

for(i in 1:1000) {
  x <- rnorm(20,500,7)
  W[i] <- var(x)
}
mean(W)
var(W)
hist(W)
qqnorm(W)
qqline(W)
```
Ja den ser normalt fordelt ud. 

## OMS 4.B

## MSRR 4.18


Let X ‚àº Pois(4), Y ‚àº Pois(12), U ‚àº Pois(3) be independent random variables.

### a) What is the exact sampling distribution of W = X + Y + U?

$$
exp[\lambda(e^t-1)]
$$

Gang dem sammen:

$$
exp[4(e^t-1)]exp[12(e^t-1)]exp[3(e^t-1)]
$$

x,y og w er uafh√¶ngig kan vi l√¶gge dem sammen:

$$
exp[19(e^t-1)]
$$

Hvor:

$$
E[] = 19 = var[]
$$







### b) Use R to simulate the sampling distribution of W and plot your results. Check that the simulated mean and standard error are close to the theoretical mean and standard error.

```{r}
set.seed(1234)
rx <- rpois(500,4) #We have created 500 random observations from poisson distribution
ry <- rpois(500,12)
ru <- rpois(500,3)
rw <- rx+ry+ru
plot(c(1:500),rw,type='p')

mean_w <- mean(rw)
mean_w
sd_w <- sqrt(var(rw))
sd_w

```


### c) Use the simulated sampling distribution to estimate P(W ‚â§ 14) and then check your estimate with an exact calculation.

```{r}
boolean_14 <- rw <= 14 #It's a boolean vector giving TRUE if observation is less than 14
p <- (sum(boolean_14))/500 #Sum(boolean_14) gives us number of rw observations which are less than 14
p
true_p <- ppois(14,19) # It gives theoretical P(W<=14)
true_p
```


## MSRR 4.20

Let X1,X2,...,X9 ‚àº N(7,3^2), and Y1,Y2,...,Y12 ‚àº N(10,5^2). Let W =
X‚àíY.


### a) Give the exact sampling distribution of W.

sample fordelingen vil v√¶re

$$
7-10=-3
9-25=-16
$$

$$
N(-3,-16)
$$


### b) Simulate the sampling distribution of W in R, and plot your results (adapt code from the previous exercise). Check that the simulated mean and standard error are close to the theoretical mean and stan- dard error.

```{r}
set.seed(1234)
size <- 1000
xDis <- numeric(1000)
yDis <- numeric(1000)
for(i in 1:size){
  xDis[i] <- mean(rnorm(9, 7, 3^2))
  yDis[i] <- mean(rnorm(12, 10, 5^2))
}
wDis <- xDis - yDis
mean(wDis)
sd(wDis)
```


### c) Use your simulation to find P(W < ‚àí1.5). Calculate an exact answer and compare.

```{r}
# part c.
# simulated answer
simMean <- mean(wDis < -1.5)
simMean
# Exact answer
exMean <- pnorm(-1.5, mean(wDis), sd(wDis))
exMean
```

## Afleverin 3: MSRR 4.16

Maria claims that she has drawn a random sample of size 30 from the exponential distribution with ùúÜ = 1‚àï10. The mean of her sample is 12.

### a) What is the expected value of a sample mean?

Sample mean er givet ved formlen

$$
\frac{1}{n}(X_1+X_2+...+X_3)
$$

Hvis vi har en eksponential fordeling:

$$
X_i  \sim epx(\frac{1}{10})
$$

$$
E[X_i] = 10
$$

$$
E[\frac{1}{n} \sum x_i] =10
$$

$$
E[sample \ mean] = 10
$$

S√• expected value er 10. 


### b) Run a simulation by drawing 1000 random samples, each of size 30, from Exp(1‚àï10), and compute the mean for each sample. What proportion of the sample means is as large or larger than 12?

```{r}
library(glue)
set.seed(0707)

sims <- numeric(10000)

for (i in 1:10000){
  x <- rexp(30, rate = 1/10)
  sims[i] <- mean(x)
}



glue("Mean har vi til at v√¶re {round(mean(sims), 4)} og
     andelen st√∏rre end 12 er: {mean(sims >= 12)}.")
```


### c) Is a mean of 12 unusual for a sample of size 30 from Exp(1‚àï10)?

```{r}
test <- mean(sims)
hist(sims)
abline(v = test, col = "red")
abline(v = 12, col = "blue")
```

Ud fra histogrammet, hvor r√∏d indikere mexxan og bl√• indikere Marias sample mean. 
Da v√¶rdien ikke falder ud over vores konfidensb√•nd, s√• vil jeg ikke sige at 12 er en us√¶dvanlig sample mean. 

[se linket](https://www.chegg.com/homework-help/questions-and-answers/416-maria-claims-drawn-random-sample-size-30-exponential-distribution-1-10-mean-sample-12--q34473670)
